---
title: 'Data Science - Homework #2'
author: "Jon Brock - JPB2210"
output: 
    github_document:
        toc: TRUE
        toc_depth: 2
---

> *"A man will be imprisoned in a room with a door that's unlocked and opens inwards; as long as it does not occur to him to pull rather than push." - Ludwig Wittgenstein*

```{r load_packages, message = FALSE}
library(tidyverse)
library(readxl)
```

## Problem #1
###### (*25 points*)
##### *Read and clean the Mr. Trash Wheel sheet:*

The following code imports the designated excel file, specifically the sheet named "Mr. Trash Wheel." There is a graphic displayed in the first row of the sheet, so I opted to skip that row when importing. Thereafter, I cleaned the column/variable names by converting them into the ever sexy "snake_case." Then I dropped the column that contained notes and removed all the rows that did not have dumpster-specific data. Lastly, I rounded the variable `sports_balls` to the nearest integer and mutated it from a `dbl` to an `int`.

```{r read_in_mr_trash_wheel_data, message = FALSE}
mr_tw_df <-
    read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
               sheet = "Mr. Trash Wheel", skip = 1) %>% 
    janitor::clean_names() %>% 
    select(-x15, -x16, -x17) %>% 
    drop_na(dumpster) %>% 
    mutate(
        sports_balls = as.integer(
            round(sports_balls, digits = 0)))
```

The following code imports the designated excel file, specifically the sheet named "2017 Precipitation." There is no graphic in this sheet, but there is an additional row of header text; I skipped that row when importing. Thereafter, I cleaned the column names as before, removed rows with missing data in the `month` column, and added a new column: `year` with `2017` as its observations.  

```{r read_in_2017_precipitation data}
precip_2017 <-
    read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
               sheet = "2017 Precipitation", skip = 1) %>%
    janitor::clean_names() %>% 
    drop_na(month) %>% 
    mutate(year = "2017")
```

The following code does everything that the previous code does, with some small changes. The sheet named "2018 Precipitation" was imported, and the addition of the `year` column reflected `2018` as its observations.  

```{r read_in_2018_precipitation data}
precip_2018 <-
    read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
               sheet = "2018 Precipitation", skip = 1) %>%
    janitor::clean_names() %>% 
    drop_na() %>% 
    mutate(year = "2018")
```

The following code binds both the `precip_2017` and `precip_2018` tibbles into one, mutates the `month` vector from a `dbl` to a `chr`, and arranges them as such: `year` > `month` > `total`.

```{r combining_precip_data}
precip_1718 <-
    bind_rows(precip_2017, precip_2018) %>% 
    mutate(month = month.name[month]) %>% 
    select(year, month, total)
```

Let's give a brief rundown on our tibbles: In `2017` there were `r count(filter(precip_2017, total > 0))` months that had precipitation, though we had data for all months. In `2018`, of the `r nrow(precip_2018)` months' worth of data there were `r count(filter(precip_2018, total > 0))` months with precipitation. The `precip_2017` tibble had a reported total precipitation of `r sum(pull(precip_2017, total))` inches. The `precip_2018` tibble had a reported total precipitation of `r sum(pull(precip_2018, total))` inches. There was a net decrease of `r sum(pull(precip_2017, total)) - sum(pull(precip_2018, total))` inches from `2017` to `2018`. The `mr_tw_df` had far more information than the two aforementioned tibbles. (`r ncol(mr_tw_df)` columns vs. `r ncol(precip_2017)` and `r ncol(precip_2018)` columns, respectively.) That tibble included key variables such as: `dumpster`, `plastic_bottles`, `cigarette_butts`, `grocery bags`, and `sports_balls`, which, what is a sports ball? (Anyone?) Regardless of what it is, in `2017` the median number of `sports_balls` in a dumpster was `r mr_tw_df %>% filter(year == 2017) %>% pull(sports_balls) %>% median()` balls.

## Problem #2
###### (*25 points*)
##### *Read and Merge 538.com Datasets:*

```{r read_in_three_538_excel_files, message = FALSE}
pols_month <- read_csv("./data/pols-month.csv")
unemployment <- read_csv("./data/unemployment.csv")
snp <- read_csv("./data/snp.csv")
```

```{r clean_pols_month_data, results = FALSE}
pols_month <- 
    pols_month %>% 
    separate(
        mon, into = (c("year", "month", "day")), remove = TRUE, convert = TRUE) %>%
    mutate(
        month = month.name[month],
        prez_dem = if_else(prez_dem == 1, "dem", "gop"),
        president = prez_dem) %>%
    select(-c(prez_gop, prez_dem, day))
```

```{r clean_snp_data, results = FALSE}
snp <-
    snp %>%
    separate(date, into = (c("month", "day", "year")), remove = TRUE, convert = TRUE) %>%
    mutate(month = month.name[month]) %>%
    select(year, month, close, -day)
```

```{r clean_unemployment_data, results = FALSE}
unemployment <-
    unemployment %>% #GOOD CODE
    pivot_longer( #GOOD CODE
        Jan:Dec, #GOOD CODE
        names_to = "Month", #GOOD CODE
        values_to = "Pct_Unemp") %>% #GOOD CODE
    mutate(
        Year = as.integer(Year),
        Month = match(Month, month.abb),
        Month = month.name[Month]) %>%  #GOOD CODE
    janitor::clean_names()
```

```{r join_all_538_datasets}
pols_snp <- left_join(pols_month, snp, by = c("year", "month"))
pols_snp_unemp <- left_join(pols_snp, unemployment, by = c("year", "month"))
```

What we have here are three separate datasets (`pols_months`, `snp`, and `unemployment`) containing US political office, stock market, and unemployment data on the national level. (Side note: 538 nailed every election prediction until...well, you know.) The `pols_months` dataset (after cleaning) contained `r ncol(pols_month)` variables, which included data on the overall count of political representation in both the Legislative and Executive branches of government for any given month and year. For example, in April '62 there were `r filter(pols_month, "year" == 1962, "month" == "April") %>% pull(sen_dem)` Democratic Senators and `XXX` GOP Senators in the US Senate.

## Problem #3
###### (*25 points*)
##### *BABY NAMES! BABY NAMES! BABY NAMES!:*

```{r clean_baby_name_data, message = FALSE}
#COMPLETED
baby_data <- #GOOD CODE
    read_csv("./data/Popular_Baby_Names.csv") %>% #GOOD CODE
    janitor::clean_names() %>% #GOOD CODE
    mutate(
        childs_first_name = str_to_lower(childs_first_name),
        ethnicity = str_to_lower(ethnicity),
        ethnicity = as.factor(ethnicity),
        gender = str_to_lower(gender),
        gender = as.factor(gender),
        year_of_birth = as.integer(year_of_birth)) %>% 
    distinct(childs_first_name, .keep_all = TRUE) #GOOD CODE
```

```{r generate_table}
baby_data %>% #TEST CODE - NOT FINALIZED
    filter(childs_first_name == "olivia") %>% 
    pivot_wider(
        names_from = year_of_birth,
        values_from = childs_first_name) %>% 
    group_by(ethnicity)

```

## Bonus Content
A handy guide for if you visit San Francisco. Bears can be vicious and unpredictable! Better to be prepared than not.

<center> ![](bear_field_guide.jpg) </center>